"use strict";
"use strict";function FM_disk(i){this.$disk=i,this.init(),this.bindEvent()}FM_disk.prototype={init:function(){this.$audio=$(".fm-player"),this.$needle=this.$disk.find(".fm-disk-needle"),this.$img=this.$disk.find("img"),this.$disk_bg=this.$disk.find(".fm-disk-bg"),this.$play=this.$disk.siblings(".fm-controls").find(".icon-play")},bindEvent:function(){var i=this;this.$audio.on("play",function(){i.$needle.addClass("play"),i.$disk_bg.addClass("play"),i.$disk_bg.css("animation-play-state","running")}),this.$audio.on("pause",function(){i.$needle.removeClass("play"),i.$disk_bg.css("animation-play-state","paused")})}},new FM_disk($(".fm-disk"));
"use strict";function FM_header(n){this.$elem=n,this.init(),this.bindEvent()}FM_header.prototype={init:function(){this.$fm_panel=$(".fm-panel"),this.$menu=this.$elem.find(".icon-menu"),this.$songName=this.$elem.find(".fm-song-name"),this.$share=this.$elem.find(".icon-share"),this.$channels_panel=this.$elem.siblings(".fm-list-panel"),this.$share_panel=this.$elem.siblings(".fm-share-panel")},bindEvent:function(){var n=this;this.$menu.on("click",function(e){e.stopPropagation(),n.$channels_panel.fadeIn("fast").data("isOpen","true")}),this.$channels_panel.on("click",function(n){$(n.currentTarget).fadeOut("fast")}),this.$fm_panel.on("click",function(){n.$channels_panel.fadeOut("fast")}),this.$share.on("click",function(e){e.stopPropagation(),n.$share_panel.fadeIn("fast")}),this.$fm_panel.on("click",function(e){n.$share_panel.fadeOut("fast")})}},new FM_header($(".fm-header"));
"use strict";function FM_Open(n){this.$open=n,this.init(),this.bindEvent()}FM_Open.prototype={constructor:FM_Open,init:function(){this.$iconOpen=this.$open.find(".icon-open"),this.$FMPanel=$(".fm-panel")},bindEvent:function(){var n=this;this.$FMPanel.draggabilly(),this.$open.on("mousedown",function(e){n.$open.toggleClass("open"),n.$iconOpen.toggleClass("open"),n.$FMPanel.toggleClass("open")})}},new FM_Open($(".fm-open"));
"use strict";function FM_PlayControls(n){this.$controls=n,this.init(),this.autoPlay(),this.bindEvent()}FM_PlayControls.prototype={init:function(){this.$audio=$(".fm-player"),this.audio=this.$audio[0],this.$songName=$(".fm-song-name"),this.$disk_img=$(".fm-disk").find("img"),this.$channelsPanel=$(".fm-list-panel"),this.channelID="public_tuijian_spring",this.$prev=this.$controls.find(".icon-prev"),this.$next=this.$controls.find(".icon-next"),this.$play_pause=this.$controls.find(".icon-play-pause"),this.$lyricPanel=$(".fm-lyric").find(".lyric-wrapper"),this.letPlay=!1,this.songArr=[],this.lyricTimeArr=[]},canPlay:function(){var n=this;this.$audio.on("canplay",function(){n.letPlay&&n.audio.play(),n.letPlay=!1})},autoPlay:function(){var n=this;this.$audio.on("ended",function(){n.letPlay=!0,n.getSong(n.channelID)})},getSong:function(n){var i=this;$.get("http://api.jirengu.com/fm/getSong.php",{channel:n}).done(function(n){i.song=JSON.parse(n).song[0],i.songReset(i.song),i.songArr.push(i.song)})},songReset:function(n){this.audio.src=n.url,this.audio.load(),this.audio.currentTime=0,this.$songName.text(n.title),this.$disk_img[0].src=n.picture,this.lyricReset(n.sid)},lyricReset:function(n){var i=this;$.post("http://api.jirengu.com/fm/getLyric.php",{sid:n}).done(function(n){var t=JSON.parse(n).lyric;$(".lyric-wrapper").children().remove(),i.lyricTimeArr=[],i.lyricFormat(t)})},lyricFormat:function(n){for(var i="",t=n.split("\n"),s=/[\[\]\{\}\(\)\\]/g,a=0;a<t.length;a++){var e=t[a].slice(10,t[a].length);e||(e="------------"),s.test(e)&&(e=e.replace(s,"")),i+='<p class="lyric-No-'+a+'">'+e+"</p>",this.getLyricTimeArr(t[a])}$(".lyric-wrapper").append(i)},getLyricTimeArr:function(n){var i=Number(n.substring(1,3)),t=Math.round(60*i+parseFloat(n.substring(4,9)));this.lyricTimeArr.push(t)},lyricPanelMove:function(n){for(var i=1;i<this.lyricTimeArr.length;i++)if(n===this.lyricTimeArr[i]){var t=35-30*i+"px",s=".lyric-No-"+i;$(s).siblings().removeClass("hightlight"),$(s).addClass("hightlight"),this.$lyricPanel.animate({top:t},300)}},timeUpdate:function(){var n=this;this.$audio.on("timeupdate",function(){var i=Math.round(n.audio.currentTime);n.lyricPanelMove(i)})},channelSelect:function(){var n=this;this.$channelsPanel.on("click","li",function(){n.audio.pause(),$(this).siblings().removeClass("list-selected"),$(this).addClass("list-selected"),n.channelID=$(this).data("channel-id"),n.letPlay=!0,n.getSong(n.channelID)})},channelsRender:function(){var n=this,i=this;$(".fm-panel").ready(function(){$.get("http://api.jirengu.com/fm/getChannels.php").done(function(t){for(var s=JSON.parse(t).channels,a="",e=0;e<s.length;e++){var l=s[e].name,o=s[e].channel_id;a+="<li data-channel-id = "+o+">"+l+"</li>"}n.$channelsPanel.append(a),$(".fm-list-panel").children().first().addClass("list-selected"),i.getSong(i.channelID),$(".fm-disk-bg").css("animation-play-state","paused")})})},bindEvent:function(){var n=this,i=this;this.channelsRender(),this.channelSelect(),this.canPlay(),this.autoPlay(),this.timeUpdate(),this.lyricPanelMove(),this.$play_pause.on("click",function(){i.audio.paused?(i.audio.play(),n.$play_pause.hasClass("icon-play")&&n.$play_pause.removeClass("icon-play").addClass("icon-pause")):(n.audio.pause(),n.$play_pause.hasClass("icon-pause")&&n.$play_pause.removeClass("icon-pause").addClass("icon-play"))}),this.$audio.on("play",function(i){n.$play_pause.hasClass("icon-play")&&n.$play_pause.removeClass("icon-play").addClass("icon-pause")}),this.$prev.on("mousedown",function(){n.audio.pause()}).on("click",function(){i.songArr.length>1&&(i.songArr.pop(),i.songReset(i.songArr[i.songArr.length-1]),i.letPlay=!0)}),this.$next.on("mousedown",function(i){n.audio.pause()}).on("click",function(){i.letPlay=!0,i.getSong(i.channelID)})}};var fm=new FM_PlayControls($(".fm-controls")),lyricObj={sid:"325908",name:"杀破狼",lyric:"[00:00.01]音乐来自百度FM, by 饥人谷\n[ti:0]\n[ar:0]\n[al:0]\n[offset:0]\n\n[00:00.00]杀破狼\n[00:03.15]演唱：JS\n[00:04.34]\n[00:04.78]哦 呀 嘿 呀....\n[00:28.59]\n[00:28.93]沉睡了千年的身体\n[00:32.67]从腐枝枯叶里苏醒\n[00:36.11]是夜莺凄凉的叹息\n[00:39.58]解开咒语\n[00:40.84]\n[00:43.05]遗忘的剑被谁封印\n[00:46.42]追随着箫声和马蹄\n[00:53.21]找到你\n[00:54.80]\n[00:55.66]最光荣的牺牲\n[00:59.04]是英雄的宿命\n[01:02.62]挥剑的瞬间心却在哭泣\n[01:08.10]\n[01:09.49]生是为了证明\n[01:12.79]爱存在的痕迹\n[01:16.46]火燃烧后更伟大的生命\n[01:22.73]\n[01:23.56]杀是为了歌颂\n[01:26.95]破灭前的壮丽\n[01:30.54]夜是狼深邃眼睛\n[01:35.50]孤独等待黎明\n[01:38.75]\n[01:51.88]看不见未来和过去\n[01:55.17]分不清生死的差异\n[01:58.75]不带走喜悦或遗憾\n[02:02.10]离开这里\n[02:03.75]\n[02:05.20]破晓和月牙在交替\n[02:08.87]我穿越过几个世纪\n[02:15.87]只为你\n[02:17.49]\n[02:18.34]当花瓣在飘零\n[02:21.64]这悲凉的风景\n[02:25.22]长袖挥不去一生刀光剑影\n[02:30.61]\n[02:35.39]生是为了证明\n[02:38.70]爱存在的痕迹\n[02:42.65]火燃烧后更伟大的生命\n[02:49.09]\n[02:49.51]杀是为了歌颂\n[02:52.82]破灭前的壮丽\n[02:56.18]夜是狼深邃眼睛\n[03:00.93]孤独等待黎明\n[03:04.80]\n[03:30.35]我是否已经注定\n[03:35.18]这流离的宿命\n[03:38.68]我残破的羽翼\n[03:43.14]直到你\n[03:45.56]是你让我 找回自己\n[03:50.57]\n[03:50.79]生是为了证明\n[03:54.02]爱存在的痕迹\n[03:57.64]火燃烧后更伟大的生命\n[04:04.16]\n[04:04.51]杀是为了歌颂\n[04:07.86]破灭前的壮丽\n[04:11.43]夜是狼深邃眼睛\n[04:16.33]孤独等待黎明\n[04:23.01]\n"};
"use strict";function FM_Progress(i){this.$progress=i,this.init(),this.bindEvent()}FM_Progress.prototype={init:function(){this.$audio=$(".fm-player"),this.audio=this.$audio[0],this.$loadHandler=this.$progress.find(".load-handler"),this.$loadLine=this.$progress.find(".load-line"),this.$curTimeText=this.$progress.find(".currentTime"),this.$totalTimeText=this.$progress.find(".totalTime"),this.timer},progressUpdate:function(){var i=this;this.$audio.on("play",function(){var t=i.audio.duration;i.timer=setInterval(function(){var a=i.audio.currentTime,e=Math.round(a/t*200)+"px";i.$curTimeText.text(i.playTimeFormat(a)),i.$loadLine.width(e),i.$loadHandler.css("left",e)},1e3),i.$totalTimeText.text(i.playTimeFormat(t))}),this.$audio.on("pause",function(){clearInterval(i.timer)})},playTimeFormat:function(i){var t=parseInt(i/60);t<10&&(t="0"+t);var a=parseInt(i%60);return a<10&&(a="0"+a),t+":"+a},handlerDrag:function(){var i=this;this.$loadHandler.draggabilly({axis:"x",containment:!0});var t=this.$loadHandler.data("draggabilly");this.$loadHandler.on("dragStart",function(){i.audio.pause()}),this.$loadHandler.on("dragMove",function(){i.audio.currentTime=t.position.x/200*i.audio.duration,i.$loadLine.width(t.position.x),i.$curTimeText.text(i.playTimeFormat(i.audio.currentTime)),$(".fm-panel").draggabilly("disable")}),this.$loadHandler.on("dragEnd",function(){i.audio.play(),$(".fm-panel").draggabilly("enable")})},bindEvent:function(){this.progressUpdate(),this.handlerDrag()}},new FM_Progress($(".fm-progress"));
"use strict";function FM_share(i){this.$share=i,this.init(),this.bindEvent()}FM_share.prototype={init:function(){this.$weibo=this.$share.find(".icon-weibo>a"),this.$douban=this.$share.find(".icon-douban>a")},bindEvent:function(){var i=this;this.$weibo.on("click",function(){i.$weibo[0].href="http://service.weibo.com/share/share.php?title=I love "+$(".fm-song-name").text()+"&pic="+$(".fm-disk-bg>img")[0].src}),this.$douban.on("click",function(){i.$douban[0].href="http://shuo.douban.com/!service/share?text=I love "+$(".fm-song-name").text()+"&image="+$(".fm-disk-bg>img")[0].src})}},new FM_share($(".fm-share-panel"));
"use strict";function FM_Volume(e){this.$volume=e,this.init(),this.bindEvent()}FM_Volume.prototype={init:function(){this.$audio=$(".fm-player"),this.audio=this.$audio[0],this.audio.volume=.51,this.volumeLineHeight=31,this.$volumeTunnel=this.$volume.siblings(".volume-tunnel"),this.$volumeHandler=this.$volumeTunnel.find(".volume-handler"),this.$volumeLine=this.$volumeTunnel.find(".volume-line")},volumeHandlerDrag:function(){var e=this;this.$volumeHandler.draggabilly({axis:"y",containment:!0});var i=this.$volumeHandler.data("draggabilly");this.$volumeHandler.on("dragMove",function(){e.audio.volume=(50-i.position.y)/50,e.volumeLineHeight=i.position.y+1,e.$volumeLine.css("height",e.volumeLineHeight),$(".fm-panel").draggabilly("disable")}),this.$volumeHandler.on("dragEnd",function(){$(".fm-panel").draggabilly("enable")})},watchVolumeChange:function(){var e=this;this.$audio.on("volumechange",function(){e.audio.muted||0===e.audio.volume?e.$volume.removeClass("icon-volume").addClass("icon-mute"):e.$volume.removeClass("icon-mute").addClass("icon-volume")})},bindEvent:function(){var e=this;this.volumeHandlerDrag(),this.watchVolumeChange(),this.$volume.on("click",function(i){i.stopPropagation(),e.$volume.hasClass("icon-mute")?(e.$volume.removeClass("icon-mute").addClass("icon-volume"),e.audio.muted=!1,e.$volumeHandler.css("top",e.volumeLineHeight-1+"px"),e.$volumeLine.css("height",e.volumeLineHeight)):(e.$volume.removeClass("icon-volume").addClass("icon-mute"),e.audio.muted=!0,e.$volumeLine.css("height",51),e.$volumeHandler.css("top","50px"))})}},new FM_Volume($(".icon-volume"));